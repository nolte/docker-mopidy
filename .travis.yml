sudo: required
language: bash
services:
  - docker
env:
  matrix:
  - MOPDIY_VERSION=2.1.0-1

notifications:
  webhooks: https://keenio-gateway.herokuapp.com/build

jobs:
  include:
    - stage: build
      script:
        - docker build -t nolte/mopidy:$(echo $MOPDIY_VERSION) -f Dockerfile --build-arg MOPDIY_VERSION=${MOPDIY_VERSION} .
    - script:
        - docker run --rm --privileged multiarch/qemu-user-static:register --reset
        - docker build -t nolte/rpi-mopidy:$(echo $MOPDIY_VERSION) -f DockerfileRPI --build-arg MOPDIY_VERSION=${MOPDIY_VERSION} .
